The following line lists scom Gateways with their failover servers.
```powershell
Get-SCOMGatewayManagementServer | Select-Object -Property DisplayName, @{Name="PrimaryServer"; Expression={($_.GetPrimaryManagementServer()).DisplayName}},@{Name="FailOverServer"; Expression={($_.GetFailoverManagementServers()).DisplayName}}
```

Returns top 20 active alerts in scom console

```powershell
Get-SCOMAlert | where ResolutionState -eq 0 | Group-Object -Property Name | Sort-Object -Property Count -Descending  | Select-Object -Property Count,Name -First 20
```

Lists Top 20 Active Alerts and if they are Monitor Based. But has a bug if theres "," in alert Name then the alert name is truncted(split). Dont worry the Remaining part is handled:)

```powershell
Get-SCOMAlert | where ResolutionState -eq 0 | Group-Object -Property Name,IsMonitorAlert | Sort-Object -Property Count -Descending  | Select-Object -Property Count, @{Name="AlertName";Expression={$result=$_.Name -split "," ;$result[0] }}  ,@{Name="IsMonitorAlert";Expression={$result=$_.Name -split "," ;$result|ForEach-Object {if ($_ -match '(True|False)'){$Matches[1]}} }} -First 20
```

Gets the count per day of the specified alert

```powershell
Get-SCOMAlert | where {$_.Name -eq 'Server Performance Exception' -and $_.ResolutionState -eq 0} | Select-Object -Property @{Name="Date";Expression={"{0:yyyy-MM-dd}" -f $_.TimeRaised}}, NetbiosComputerName | Group-Object -Property Date | Sort-Object -Property Name -Descending | Select-Object -Property Name,Count
```

Gets the count of alerts generated by each computer

```powershell
Get-SCOMAlert | where {$_.Name -eq 'Server Performance Exception' -and $_.ResolutionState -eq 0}  | Group-Object -Property NetbiosComputerName | Sort-Object -Property Count -Descending |Select-Object -Property Name,Count
```


Run the below line on the management server to figure out which agents are connected.

```powershell

 Get-NetTCPConnection -LocalPort 5723 | Format-Table -Property @{Name="LocalDNS";Expression={(resolve-dnsname $_.LocalAddress).NameHost}},LocalPort,@{Name="RemoteDNS";Expression={(resolve-dnsname $_.RemoteAddress).NameHost}},RemotePort,@{Name="ProcessName";Expression={(Get-Process -PID ($_.OwningProcess)).Name}},state 
 
 ```
